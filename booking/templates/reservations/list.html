{% extends "base.html" %}
{% block content %}
<div class="admin-container">
  <div class="header-section">
    <h2>Reservas</h2>
    {% if user.is_authenticated %}
      <a href="/reservas/nueva/" class="btn btn-primary">Nueva reserva</a>
    {% else %}
      <p><em>Inicia sesión para crear reservas</em></p>
    {% endif %}
  </div>

{% if reservations %}
  <div class="reservations-list">
    {% for reservation in reservations %}
      <div class="reservation-card">
        <div class="reservation-header">
          <h3>Salón {{ reservation.room.code }}</h3>
          <span class="reservation-date">{{ reservation.date|date:"d/m/Y" }}</span>
        </div>
        <div class="reservation-details">
          <p><strong>Horario:</strong> {{ reservation.start_time|time:"H:i" }} - {{ reservation.end_time|time:"H:i" }}</p>
          <p><strong>Usuario:</strong> 
            {% if reservation.user %}
              {{ reservation.user.username }}
            {% else %}
              Anónimo
            {% endif %}
          </p>
          {% if reservation.items.all %}
            <div class="materials">
              <strong>Materiales:</strong>
              <ul>
                {% for item in reservation.items.all %}
                  <li>{{ item.material.name }} ({{ item.quantity }})</li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}
          <p class="created-at">Creada: {{ reservation.created_at|date:"d/m/Y H:i" }}</p>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="empty-state">
    <p>No hay reservas registradas.</p>
    {% if user.is_authenticated %}
      <a href="/reservas/nueva/" class="btn btn-primary">Crear primera reserva</a>
    {% endif %}
  </div>
{% endif %}
</div>

{% endblock %}
